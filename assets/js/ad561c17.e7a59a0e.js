"use strict";(self.webpackChunkpiwik_pro=self.webpackChunkpiwik_pro||[]).push([[8549],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=c(a),k=i,m=u["".concat(s,".").concat(k)]||u[k]||d[k]||r;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=k;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:i,l[1]=o;for(var c=2;c<r;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},3243:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var n=a(7462),i=(a(7294),a(3905));const r={},l="Piwik PRO SDK for Android",o={unversionedId:"data-collection/mobile/Piwik_PRO_SDK_for_Android",id:"data-collection/mobile/Piwik_PRO_SDK_for_Android",title:"Piwik PRO SDK for Android",description:"SDK configuration",source:"@site/docs/data-collection/mobile/Piwik_PRO_SDK_for_Android.md",sourceDirName:"data-collection/mobile",slug:"/data-collection/mobile/Piwik_PRO_SDK_for_Android",permalink:"/docs/data-collection/mobile/Piwik_PRO_SDK_for_Android",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/data-collection/mobile/Piwik_PRO_SDK_for_Android.md",tags:[],version:"current",frontMatter:{},sidebar:"dataCollectionSideBar",previous:{title:"index",permalink:"/docs/data-collection/"},next:{title:"Piwik PRO SDK for Flutter",permalink:"/docs/data-collection/mobile/Piwik_PRO_SDK_for_Flutter"}},s={},c=[{value:"SDK configuration",id:"sdk-configuration",level:2},{value:"Server",id:"server",level:3},{value:"Client",id:"client",level:3},{value:"Including the library",id:"including-the-library",level:4},{value:"Configuration",id:"configuration",level:4},{value:"Using Piwik PRO SDK with the Kotlin programming language",id:"using-piwik-pro-sdk-with-the-kotlin-programming-language",level:4},{value:"Using Piwik PRO SDK",id:"using-piwik-pro-sdk",level:2},{value:"Data anonymization",id:"data-anonymization",level:3},{value:"Tracking screen views",id:"tracking-screen-views",level:3},{value:"Tracking custom events",id:"tracking-custom-events",level:3},{value:"Tracking exceptions",id:"tracking-exceptions",level:3},{value:"Tracking social interactions",id:"tracking-social-interactions",level:3},{value:"Tracking deep links and campaigns",id:"tracking-deep-links-and-campaigns",level:3},{value:"Tracking downloads",id:"tracking-downloads",level:3},{value:"Tracking application installs",id:"tracking-application-installs",level:3},{value:"Tracking outlinks",id:"tracking-outlinks",level:3},{value:"Tracking search operations",id:"tracking-search-operations",level:3},{value:"Tracking content impressions and interactions",id:"tracking-content-impressions-and-interactions",level:3},{value:"Tracking goals",id:"tracking-goals",level:3},{value:"Tracking ecommerce transactions",id:"tracking-ecommerce-transactions",level:3},{value:"Tracking custom variables",id:"tracking-custom-variables",level:3},{value:"Tracking custom dimensions",id:"tracking-custom-dimensions",level:3},{value:"Tracking user profile attributes",id:"tracking-user-profile-attributes",level:3},{value:"Reading user profile attributes",id:"reading-user-profile-attributes",level:3},{value:"Checking audience membership",id:"checking-audience-membership",level:3},{value:"Advanced usage",id:"advanced-usage",level:2},{value:"User ID",id:"user-id",level:3},{value:"User email address",id:"user-email-address",level:3},{value:"Device ID",id:"device-id",level:3},{value:"Visitor ID",id:"visitor-id",level:3},{value:"Sessions",id:"sessions",level:3},{value:"Dispatching",id:"dispatching",level:3},{value:"Custom queries",id:"custom-queries",level:3},{value:"Default custom variables",id:"default-custom-variables",level:3},{value:"Local storage limits",id:"local-storage-limits",level:3},{value:"Opt out",id:"opt-out",level:3},{value:"Dry run",id:"dry-run",level:3}],p={toc:c},u="wrapper";function d(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"piwik-pro-sdk-for-android"},"Piwik PRO SDK for Android"),(0,i.kt)("h2",{id:"sdk-configuration"},"SDK configuration"),(0,i.kt)("h3",{id:"server"},"Server"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You need a Piwik PRO account on the cloud or an on-premises setup which your mobile app will communicate with. For details, please visit the ",(0,i.kt)("a",{parentName:"li",href:"https://piwik.pro"},"Piwik PRO website"),"."),(0,i.kt)("li",{parentName:"ul"},"Create a new website (or app) in the Piwik PRO web interface."),(0,i.kt)("li",{parentName:"ul"},'Copy and note the Website ID from "Administration > Websites & apps > Installation" and your server address.')),(0,i.kt)("h3",{id:"client"},"Client"),(0,i.kt)("h4",{id:"including-the-library"},"Including the library"),(0,i.kt)("p",null,"Add the JitPack repository to your root ",(0,i.kt)("inlineCode",{parentName:"p"},"build.gradle")," file at the end of repositories:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-groovy"},"  allprojects {\n    repositories {\n      ...\n      maven { url 'https://jitpack.io' }\n    }\n  }\n")),(0,i.kt)("p",null,"Then add the dependency to the application module ",(0,i.kt)("inlineCode",{parentName:"p"},"build.gradle")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-groovy"},"  dependencies {\n      implementation 'pro.piwik:sdk-framework-android:VERSION'\n  }\n")),(0,i.kt)("p",null,"Replace ",(0,i.kt)("inlineCode",{parentName:"p"},"VERSION")," with the latest release name, e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"1.0.3"),"."),(0,i.kt)("h4",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"In order to set up the Piwik PRO tracker, you have two options:"),(0,i.kt)("p",null,"1","."," Extend ",(0,i.kt)("inlineCode",{parentName:"p"},"PiwikApplication")," class with your Android ",(0,i.kt)("inlineCode",{parentName:"p"},"Application")," class. It forces implementation of one abstract method. That approach is used in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/PiwikPRO/piwik-pro-sdk-demo-android"},"Piwik PRO SDK demo app")," as below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class YourApplication extends PiwikApplication{\n    @Override\n    public TrackerConfig onCreateTrackerConfig() {\n        return TrackerConfig.createDefault("https://your.piwik.pro.server.com", "01234567-89ab-cdef-0123-456789abcdef");\n    }\n}\n')),(0,i.kt)("p",null,"2","."," Manage the ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," on your own. To configure the ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker"),' you will need a server address and website ID (you can find it in "Administration > Websites & apps > Installation"):'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class YourApplication extends Application {\n    private Tracker tracker;\n    public synchronized Tracker getTracker() {\n        if (tracker == null) tracker = Piwik.getInstance(this).newTracker(new TrackerConfig("https://your.piwik.pro.server.com", "01234567-89ab-cdef-0123-456789abcdef", "Default Tracker"));\n        return tracker;\n    }\n}\n')),(0,i.kt)("p",null,"It is not recommended to create multiple ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," instances for the same target as it may lead to over-count of metrics. It is highly recommended to create and manage the tracker in the Application class (to make sure there is only one instance of the tracker). The ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," is thread-safe and can be shared across the application."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"Tracker tracker = ((PiwikApplication) getApplication()).getTracker();\n")),(0,i.kt)("p",null,"The application is ready to use Piwik PRO SDK."),(0,i.kt)("h4",{id:"using-piwik-pro-sdk-with-the-kotlin-programming-language"},"Using Piwik PRO SDK with the Kotlin programming language"),(0,i.kt)("p",null,"The Piwik PRO SDK is written in the Java programming language. Nevertheless calling Piwik PRO SDK interface elements in classes written in Kotlin will not be an issue as the code written in Java can be called from Kotlin in a natural way.\nWhen we edit a Kotlin class file and type in a reference to the Piwik PRO SDK component, a Kotlin syntax interface will be shown in the code completion."),(0,i.kt)("p",null,"Example of using the method to track a view in Java:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'Tracker tracker = ((PiwikApplication) getApplication()).getTracker();\nTrackHelper.track().screen("your_activity_path").title("Title").with(tracker);\n')),(0,i.kt)("p",null,"Same example in Kotlin:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'val tracker: Tracker = (application as PiwikApplication).tracker\nTrackHelper.track().screen("your_activity_path").title("Title").with(tracker)\n')),(0,i.kt)("p",null,"For more on using existing Java code in Kotlin files, see the documentation ",(0,i.kt)("a",{parentName:"p",href:"https://kotlinlang.org/docs/java-interop.html"},'"Calling Java from Kotlin\ufeff"'),"."),(0,i.kt)("h2",{id:"using-piwik-pro-sdk"},"Using Piwik PRO SDK"),(0,i.kt)("p",null,"It is recommended to use ",(0,i.kt)("inlineCode",{parentName:"p"},"TrackerHelper")," class. It has methods for all common actions, which can be chained in a way that facilitates the correct order and use. Combine it with IDE autocompletion and using the SDK will be more convenient."),(0,i.kt)("p",null,"For tracking each event with ",(0,i.kt)("inlineCode",{parentName:"p"},"TrackHelper"),", you will need to pass ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," instance. The way of getting the correct ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," instance depends on the configuration option (see section above):"),(0,i.kt)("p",null,"1","."," Your Android ",(0,i.kt)("inlineCode",{parentName:"p"},"Application")," class extend ",(0,i.kt)("inlineCode",{parentName:"p"},"PiwikApplication")," class"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"Tracker tracker = ((PiwikApplication) getApplication()).getTracker();\n")),(0,i.kt)("p",null,"2","."," You manage the ",(0,i.kt)("inlineCode",{parentName:"p"},"Tracker")," yourself"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"Tracker tracker = ((YourApplication) getApplication()).getTracker();\n")),(0,i.kt)("p",null,"In further examples we will assume usage of the first option."),(0,i.kt)("h3",{id:"data-anonymization"},"Data anonymization"),(0,i.kt)("p",null,"Anonymization is the feature that allows tracking a user's activity for aggregated data analysis even if the user doesn't consent to track the data. If a user does not agree to be tracked, he will not be identified as the same person across multiple sessions."),(0,i.kt)("p",null,"Personal data will not be tracked during the session (",(0,i.kt)("a",{parentName:"p",href:"#user-id"},"user ID"),", ",(0,i.kt)("a",{parentName:"p",href:"#user-email-address"},"email")," and ",(0,i.kt)("a",{parentName:"p",href:"https://support.google.com/googleplay/android-developer/answer/6048248?hl=en"},"device ID"),").\nIf the anonymization is enabled, a new ",(0,i.kt)("a",{parentName:"p",href:"#visitor-id"},"visitor ID")," will be created each time the application starts."),(0,i.kt)("p",null,"Anonymization is enabled by default."),(0,i.kt)("p",null,"You can turn the anonymization on and off using the ",(0,i.kt)("inlineCode",{parentName:"p"},"setAnonymizationState")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"((PiwikApplication) getApplication()).getTracker().setAnonymizationState(false);\n")),(0,i.kt)("p",null,"You can also check the anonymization status using the ",(0,i.kt)("inlineCode",{parentName:"p"},"isAnonymizationOn")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"((PiwikApplication) getApplication()).getTracker().isAnonymizationOn();\n")),(0,i.kt)("h3",{id:"tracking-screen-views"},"Tracking screen views"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"During a valid tracking session, you can track screen views which represent the content the user is viewing in the application. To send a visit on the screen, set the screen path and title on the tracker. This path is internally translated by the SDK to an HTTP URL as the Piwik PRO server uses URLs for tracking views. Additionally, Piwik PRO SDK uses prefixes which are inserted in a generated URL for various types of action(s). For tracking screen views it will use a prefix ",(0,i.kt)("em",{parentName:"p"},"screen")," by default, however, automatic prefixing can be disabled with the ",(0,i.kt)("inlineCode",{parentName:"p"},"tracker.setPrefixing(false)")," option."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class YourActivity extends Activity {\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        Tracker tracker = ((PiwikApplication) getApplication()).getTracker();\n        TrackHelper.track().screen("your_activity_path").title("Title").with(tracker);\n    }\n}\n\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A path (required) \u2013 each screen should be mapped to the URL path")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A title (optional) \u2013 the title of the action being tracked."))),(0,i.kt)("p",null,"To automatically use the activity-stack as a path and activity title as a name, use the overloaded screen method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class YourActivity extends Activity {\n   ...\n   TrackHelper.track().screen(YourActivity).with(tracker);\n   ...\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"An activity (required) \u2013 current instance of android ",(0,i.kt)("inlineCode",{parentName:"li"},"Activity")," class.")),(0,i.kt)("p",null,"In order to bind the tracker to your applications, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"screens")," method. This method will automatically track all open application activities(views) keeping the activity-stack as a path and activity title as the name:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"TrackHelper.track().screens(getApplication()).with(tracker);\n")),(0,i.kt)("p",null,"Alternatively, it is also possible to define a list of views that will be sent with a single event:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().screens(Arrays.asList("android_test/test1", "android_test/test2")).with(tracker);\n')),(0,i.kt)("h3",{id:"tracking-custom-events"},"Tracking custom events"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"To collect data about the user's interaction with the interactive components of the application, like a button presses or the use of a particular item in the game - use ",(0,i.kt)("inlineCode",{parentName:"p"},"event")," method."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().event("category", "action").path("/main/actionScreen").name("label").value(1000f).with(tracker);\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"track")," method allows the specification of the following parameters:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A category (required) \u2013 this String defines the event category. You may define event categories based on the class of user actions (e.g. clicks, gestures, voice commands), or you may define them based on the features available in your application (e.g. play, pause, fast forward, etc.).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An action (required) \u2013 this String defines the specific event action within the category specified. In the example, we are effectively saying that the category of the event is user clicks, and the action is a button click.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A name (optional) \u2013 this String defines a label associated with the event. For example, if you have multiple button controls on a screen, you may use the label to specify the specific view control identifier that was clicked.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A value (optional) \u2013 this Float defines a numerical value associated with the event. For example, if you were tracking "Buy" button clicks, you may log the number of items being purchased or their total cost.')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A path (optional) \u2013 the path under which this event occurred."))),(0,i.kt)("p",null,"For more resources, please visit:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://help.piwik.pro/support/getting-started/custom-event/"},"Custom Events Overview")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://piwik.pro/blog/event-tracking-ultimate-guide/"},"Ultimate guide to event tracking"),".")),(0,i.kt)("h3",{id:"tracking-exceptions"},"Tracking exceptions"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"Caught exceptions are errors in your app for which you've defined an exception handling code, such as the occasional timeout of a network connection during a request for data. Exceptions are tracked on the server in a similar way as screen views. "),(0,i.kt)("p",null,"If you provide cought exception to the ",(0,i.kt)("inlineCode",{parentName:"p"},"exception")," method, URL will contain the package name, activity path, method name and line number where crash occurred.\nMeasure a caught exception by setting the exception field values on the tracker and sending the hit, as with this example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'try {\n   // perform action\n} catch(Exception ex) {\n   TrackHelper.track().exception(ex).description("Content download error").with(tracker);\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An exception (optional) \u2013 Caught exception instance.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A description (optional) \u2013 additional information about the issue."))),(0,i.kt)("p",null,"Bear in mind that Piwik is not a crash tracker therefore use this sparingly."),(0,i.kt)("h3",{id:"tracking-social-interactions"},"Tracking social interactions"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"Social interactions such as likes, shares and comments in various social networks can be tracked as below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},' TrackHelper.track().socialInteraction("Like", "Facebook").with(tracker);\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'An interaction (required) \u2013 defines the social interaction, e.g. "Like".')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A network (required) \u2013 defines social network associated with interaction, e.g. "Facebook"'))),(0,i.kt)("h3",{id:"tracking-deep-links-and-campaigns"},"Tracking deep links and campaigns"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"Tracking ",(0,i.kt)("a",{parentName:"p",href:"https://help.piwik.pro/support/reports/campaign-report/"},"campaigns")," URLs configured with the online ",(0,i.kt)("a",{parentName:"p",href:"https://piwik.pro/url-builder-tool/"},"Campaign URL Builder tool"),", allow you to measure how different campaigns (for example with Facebook ads or direct emails) bring traffic to your application. For this purpose you may use a deep link with the campaign parameters. You can track these URLs from the application via the ",(0,i.kt)("inlineCode",{parentName:"p"},"campaign")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'    TrackHelper.track().campaign("https://www.example.com?pk_campaign=Email-SummerDeals&pk_keyword=LearnMore");\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A URL (required) \u2013 the campaign URL. HTTPS, HTTP and FTP are valid, however, the URL must contain campaign name and keyword parameters.")),(0,i.kt)("p",null,"The information contained in the campaign URL or the deep link will be tracked when the first screen event is triggered."),(0,i.kt)("h3",{id:"tracking-downloads"},"Tracking downloads"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"You can track the installations initiated by your application. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'    TrackHelper.track().sendDownload("http://your.server.com/bonusmap.zip").with(getTracker());\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A URL (required) \u2013 the URL of the downloaded content.")),(0,i.kt)("p",null,"No prefixes are used for tracking downloads, but each event of this type use an additional parameter ",(0,i.kt)("inlineCode",{parentName:"p"},"download")," whose value equals to specified URL. On the analytics panel, all downloads can be viewed in the corresponding section."),(0,i.kt)("h3",{id:"tracking-application-installs"},"Tracking application installs"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"You can also track installations of your application. This event is sent to the server only once per application installation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"    TrackHelper.track().sendApplicationDownload().with(getTracker());\n")),(0,i.kt)("p",null,"Application installation is only tracked during the first launch. In the case of the application being installed but not run, the app installation will not be tracked."),(0,i.kt)("h3",{id:"tracking-outlinks"},"Tracking outlinks"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"For tracking outlinks to external websites or other apps opened from your application use the ",(0,i.kt)("inlineCode",{parentName:"p"},"outlink")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().outlink(new URL("yourScheme://address.app")).with(getTracker());\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A outlink (required) \u2013 defines the outlink target.")),(0,i.kt)("h3",{id:"tracking-search-operations"},"Tracking search operations"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"Tracking search operations allow the measurement of popular keywords used for various search operations performed inside your application. It can be done via the ",(0,i.kt)("inlineCode",{parentName:"p"},"search")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().search("Space").category("Movies").count(3).with(getTracker());\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A keyword (required) \u2013 the searched query that was used in the app.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A category (optional) \u2013 specify a search category.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A count (optional) \u2013 we recommend setting the search count to the number of search results displayed on the results page. When keywords are tracked with a count of 0, they will appear in the "No Result Search Keyword" report.'))),(0,i.kt)("h3",{id:"tracking-content-impressions-and-interactions"},"Tracking content impressions and interactions"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"You can track an impression of an ad in your application as below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().impression("Android content impression").piece("banner").target("https://www.dn.se/").with(getTracker());\n')),(0,i.kt)("p",null,"When the user interacts with the ad by tapping on it, you can also track it with a similar method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().interaction("Android content impression", "click").piece("banner").target("https://www.dn.se/").with(getTracker());\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A contentName (required) \u2013 the name of the content, e.g. "Ad Foo Bar".')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A interaction (required) \u2013 type of interaction, e.g. click.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A piece (optional) \u2013 the actual content. For instance, the path to an image, video, audio or any text.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A target (optional) \u2013 the target of the content. For instance the URL of a landing page."))),(0,i.kt)("h3",{id:"tracking-goals"},"Tracking goals"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,'By default, goals are defined as "matching" parts of the screen path or screen title. If you want to trigger a conversion manually or track some user interaction, call the method ',(0,i.kt)("inlineCode",{parentName:"p"},"goal"),". ",(0,i.kt)("a",{parentName:"p",href:"https://help.piwik.pro/support/reports/goals/"},"Read more about what a goal is in the Help Center.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track().goal("27ecc5e3-8ae0-40c3-964b-5bd8ee3da059").revenue(revenue).with(tracker)\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A goal (required) \u2013 a tracking request will trigger a conversion for the goal of the website being tracked with this ID.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Revenue (optional) \u2013 a monetary value that has been generated as revenue by goal conversion."))),(0,i.kt)("p",null,'Create, view or manage goals is available in the Analytics tab, "Goals" left menu, "Manage goals" section.'),(0,i.kt)("h3",{id:"tracking-ecommerce-transactions"},"Tracking ecommerce transactions"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"If your organization depends on online sales, you need detailed analysis to transform raw e-commerce stats into actionable insights. Revenue, orders, conversion rates, and a host of other product statistics can be analyzed by integrating Piwik with your e-commerce solution."),(0,i.kt)("p",null,"SDK provides the ",(0,i.kt)("inlineCode",{parentName:"p"},"order")," method that can be used for tracking the orders (including the order items).\nSample usage:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'Tracker tracker = ((YourApplication) getApplication()).getTracker();\nEcommerceItems items = new EcommerceItems();\n// EcommerceItems.Item("<sku>").name("<product>").category("<category>").price(<cents>).quantity(<number>)\nitems.addItem(new EcommerceItems.Item("0123456789012").name("Polo T-shirt").category("Men\'s T-shirts").price(3000).quantity(2));\nitems.addItem(new EcommerceItems.Item("0129876543210").name("Leather shoes").category("Shoes").price(40000).quantity(1));\n\nTrackHelper.track().order("orderId",124144).subTotal(33110).tax(9890).shipping(1000).discount(0).items(items).with(tracker);\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"orderId")," (required) \u2013 a unique String identifying the order")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"grandTotal")," (required) \u2013  Total amount of the order, in cents")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"subTotal")," (optional) \u2013  the subTotal (net price) for the order, in cents")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"tax")," (optional) \u2013  the tax for the order, in cents")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"shipping")," (optional) \u2013  the shipping for the order, in cents")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"discount")," (optional) \u2013  the discount for the order, in cents")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"items")," (optional) \u2013  the items included in the order, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"EcommerceItems")," class to instantiate items"))),(0,i.kt)("h3",{id:"tracking-custom-variables"},"Tracking custom variables"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"The feature will soon be disabled. We recommend using ",(0,i.kt)("a",{parentName:"em",href:"#tracking-custom-dimensions"},"custom dimensions")," instead.")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,'A custom variable is a custom name-value pair that you can assign to your users or screen views, and then visualize the reports of how many visits, conversions, etc. for each custom variable. A custom variable is defined by a name \u2014 for example, "User status" \u2014 and a value \u2013 for example, "LoggedIn" or "Anonymous". It is required for names and values to be encoded in UTF-8.'),(0,i.kt)("p",null,"Each custom variable has a scope. There are two types of custom variables scope - ",(0,i.kt)("em",{parentName:"p"},"visit scope")," and ",(0,i.kt)("em",{parentName:"p"},"screen scope"),". The visit scope can be used for any tracking action, and the screen scope can only be applied to tracking screen views."),(0,i.kt)("p",null,"To set the custom variable of the screen scope, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"variable")," method in the tracking chain:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track()\n       .variable(1, "filter", "price")\n       .variable(2, "language", "en");\n\nTrackHelper.track()\n       .screen("/custom_vars")\n       .title("Custom Vars")\n       .with(getTracker());\n')),(0,i.kt)("p",null,"When screen custom variable is set and the screen event is called, the screen custom variable will be removed from the list of screen custom variables.\nThe above code can also be written in the following way."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track()\n       .variable(1, "filter", "price")\n       .variable(2, "language", "en")\n       .screen("/custom_vars")\n       .title("Custom Vars")\n       .with(getTracker());\n')),(0,i.kt)("p",null,"To use the custom variable of the visit scope, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"visitVariables")," method in the tracking chain:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track()\n       .visitVariables(1, "filter", "price")\n       .visitVariables(2, "language", "en");\nTrackHelper.track()\n       .event("category", "action")\n       .with(tracker);\n')),(0,i.kt)("p",null,"In contrast to the screen custom variables, the visit custom variable will not be removed when the event is called."),(0,i.kt)("p",null,"Please note that the ",(0,i.kt)("a",{parentName:"p",href:"#default-custom-variables"},"Default custom variables")," option is enabled by default. With this option turned on, use the custom variables with indexes greater than 3 or the visit scope custom variables with indexes 1-3."),(0,i.kt)("p",null,"In case you don't need the default custom variable, you can disable it. See below the section regarding default custom variables and how to disable them."),(0,i.kt)("p",null,"Custom variable is defined by three parameters:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'An index (required) \u2013 a given custom variable name must always be stored in the same "index" per session. For example, if you choose to store the variable name = "Gender" in index = 1 and you record another custom variable in index = 1, then the "Gender" variable will be deleted and replaced with a new custom variable stored in index 1.')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A name (required) \u2013 this String defines the name of a specific Custom Variable such as "User type" (Limited to 200 characters).')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'A value (required) \u2013 this String defines the value of a specific Custom Variable such as "Customer" (Limited to 200 characters).'))),(0,i.kt)("h3",{id:"tracking-custom-dimensions"},"Tracking custom dimensions"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Analytics")),(0,i.kt)("p",null,"To track a custom name-value pair assigned to your users or screen views, use ",(0,i.kt)("a",{parentName:"p",href:"https://help.piwik.pro/analytics/custom-dimensions/"},"Custom Dimensions"),". Note that the custom value data is not sent by itself, but only with other tracking actions such as screen views, events or other tracking action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track()\n       .dimension(1, "visit")\n       .dimension(2, "dashboard")\n       .screen("Home screen")\n       .with(tracker);\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"1")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," are our dimension slots and ",(0,i.kt)("inlineCode",{parentName:"p"},"visit"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"dashboard")," are the dimension values for the tracked screen view."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'TrackHelper.track()\n       .dimension(1, "visit")\n       .dimension(2, "billing");\nTrackHelper.track()\n       .event("category", "action")\n       .with(tracker);\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"1")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"2")," are our dimension slots and ",(0,i.kt)("inlineCode",{parentName:"p"},"visit"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"billing")," are the dimension values for the tracked event."),(0,i.kt)("p",null,"Once the event is triggered, the dimensions are deleted and will not be sent with the next event. If you want to send dimensions with the next event, you must set them again."),(0,i.kt)("h3",{id:"tracking-user-profile-attributes"},"Tracking user profile attributes"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Audience Manager")),(0,i.kt)("p",null,"The Audience Manager stores visitors' profiles which have data from a variety of sources. One of them can be a mobile application. It is possible to enrich the profiles with more attributes by passing any key-value pair e.g. gender: male, favourite food: Italian, etc. It is recommended to set additional user identifiers such as ",(0,i.kt)("a",{parentName:"p",href:"#user-email-address"},"email")," or ",(0,i.kt)("a",{parentName:"p",href:"#user-id"},"User ID")," which will allow the enrichment of existing profiles or merging of profiles rather than creating a new profile. For example, if the user visited the website, performed some actions, filled in a form with his email (his data was tracked and profile created in Audience Manager) and ",(0,i.kt)("em",{parentName:"p"},"Used only by Audience Manager")," started using a mobile application, the existing profile will be enriched only if the email was set. Otherwise, a new profile will be created."),(0,i.kt)("p",null,"For sending profile attributes use ",(0,i.kt)("inlineCode",{parentName:"p"},"audienceManagerSetProfileAttribute")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'getTracker().setUserMail("john@doe.com");\n...\nTrackHelper.track().audienceManagerSetProfileAttribute("food", "pizza").add("color", "green").with(getTracker());\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A name (required) \u2013 defines the profile attribute name (non-null string).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A value (required) \u2013 defines the profile attribute value (non null string).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An ",(0,i.kt)("inlineCode",{parentName:"p"},"add")," (chain method) \u2013 used to specify more attributes to the user within the same event."))),(0,i.kt)("p",null,"Aside from attributes, each event also sends parameters which are retrieved from the tracker instance:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"WEBSITE_ID - always sent,"),(0,i.kt)("li",{parentName:"ul"},"USER_ID - if it is set. ",(0,i.kt)("a",{parentName:"li",href:"#user-id"},"Read more")," about the User ID,"),(0,i.kt)("li",{parentName:"ul"},"EMAIL - if it is set. ",(0,i.kt)("a",{parentName:"li",href:"#user-email-address"},"Read more")," about the email,"),(0,i.kt)("li",{parentName:"ul"},"VISITOR_ID - always sent, ID of the mobile application user, generated by SDK"),(0,i.kt)("li",{parentName:"ul"},"DEVICE_ID - an ",(0,i.kt)("a",{parentName:"li",href:"https://support.google.com/googleplay/android-developer/answer/6048248?hl=en"},"Advertising ID")," that, by default, is fetched automatically when the tracker instance is created. In order to set device ID see ",(0,i.kt)("a",{parentName:"li",href:"#device-id"},"Device ID")," section below.")),(0,i.kt)("p",null,"Profile attributes for the user that are tracked will be shown on the Audience Manager - Profile Browser tab."),(0,i.kt)("p",null,"Audience manager events are dispatched together with analytics events. Therefore, settings set in the tracker for analytics events processing (dispatch interval, cache size and age, etc.) will be same for audience manager events. Once the audience manager event is dispatched, it is no longer stored locally."),(0,i.kt)("h3",{id:"reading-user-profile-attributes"},"Reading user profile attributes"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Audience Manager")),(0,i.kt)("p",null,"It is possible to read the attributes of a given profile, however, with some limitations. Due to security reasons (to avoid personal data leakage), it is possible to read only attributes that were enabled for API access (whitelisted) in the Attributes section in Audience Manager. To get user profile attributes use the ",(0,i.kt)("inlineCode",{parentName:"p"},"audienceManagerGetProfileAttributes")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'        getTracker().audienceManagerGetProfileAttributes(new Tracker.OnGetProfileAttributes() {\n            @Override\n            public void onAttributesReceived(Map<String, String> attributes) {\n                // handle result\n            }\n\n            @Override\n            public void onError(String errorData) {\n                errorData = TextUtils.isEmpty(errorData) ? "Network error": errorData;\n                // handle error\n            }\n        });\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An OnGetProfileAttributes (required) \u2013 callback to handle request result (call is asynchronous), has two methods ",(0,i.kt)("inlineCode",{parentName:"p"},"void onAttributesReceived(Map<String, String> attributes)")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"void onError(String errorData)"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An attributes (output) \u2013 dictionary of key-value pairs, where each pair represents the attribute name (key) and value.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An errorData (output) \u2013 in case of error, only this method will be called. The method passes the error string."))),(0,i.kt)("h3",{id:"checking-audience-membership"},"Checking audience membership"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Requires Audience Manager")),(0,i.kt)("p",null,"Audiences are allowed to check whether or not the user belongs to a specific group of users defined in the data manger panel based on analytics data and audience manager profile attributes. You can check if the user belongs to a given audience, for example, to show a special offer. To check it, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"checkAudienceMembership")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().checkAudienceMembership(audienceId, new Tracker.OnCheckAudienceMembership() {\n            @Override\n            public void onChecked(boolean isMember) {\n                // handle result\n            }\n\n            @Override\n            public void onError(String errorData) {\n                // handle error\n            }\n        });\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An audienceId (required) \u2013 ID of the audience (Audience Manager -> Audiences tab)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An OnCheckAudienceMembership (required) \u2013 callback to handle request result (call is asynchronous), has two methods ",(0,i.kt)("inlineCode",{parentName:"p"},"void onChecked(boolean isMember)")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"void onError(String errorData)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An isMember (output) \u2013 a boolean value that indicates if user belongs to audience with given ID")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"An errorData (output) \u2013 in case of error, only this method will be called. The method passes the error string."))),(0,i.kt)("h2",{id:"advanced-usage"},"Advanced usage"),(0,i.kt)("h3",{id:"user-id"},"User ID"),(0,i.kt)("p",null,"UserID will allow the association of events from various sources to the same user. Each time a new visitor enters your page, Piwik PRO assigns a cookie containing a random string of characters. The purpose of this cookie is for Piwik PRO to be able to recognize the same visitor whenever the website is visited again. However, instead of a random string, you can assign your visitors with your own human-friendly name (ex. visitor email). ",(0,i.kt)("a",{parentName:"p",href:"https://help.piwik.pro/support/getting-started/userid/"},"Learn more about the user ID here"),". In order to set UserID, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setUserId")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'getTracker().setUserId("John Doe");\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A UserID (required) \u2013 any non-empty unique string identifying the user. Passing null will delete the current UserID")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"userID")," will not be sent if the data anonymization is enabled."),(0,i.kt)("h3",{id:"user-email-address"},"User email address"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Used only by Audience Manager")),(0,i.kt)("p",null,"The user email address is an optional parameter for user identification. Similar to UserID, it allows the association of events from various sources to the same user. To set user email use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setUserMail")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'getTracker().setUserMail("john@doe.com");\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A userMail (required) \u2013 any non-null string representing email address")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"userMail")," will not be send if the data anonymization is enabled."),(0,i.kt)("p",null,"Setting up an email helps the Audience Manager to enrich existing profiles or merge profiles which come from other sources (if they also have an email). Check ",(0,i.kt)("a",{parentName:"p",href:"#tracking-user-profile-attributes"},"Tracking user profile attributes")," for more information."),(0,i.kt)("h3",{id:"device-id"},"Device ID"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Used only by Audience Manager")),(0,i.kt)("p",null,"The device ID is used to track the AAID (identifier for advertising). The AAID is an additional, non-empty unique string identifying the device. By default, device ID fetched automatically when the tracker instance is created."),(0,i.kt)("p",null,"To turn off automatic fetch, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setTrackDeviceId(boolean isTracked)")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().setTrackDeviceId(false);\n")),(0,i.kt)("p",null,"To set custom deviceID, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setDeviceId(String deviceID)")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().setDeviceId(String deviceID);\n")),(0,i.kt)("p",null,"If custom ",(0,i.kt)("inlineCode",{parentName:"p"},"deviceID")," value is not set, then default automatically generated ",(0,i.kt)("inlineCode",{parentName:"p"},"deviceID")," value is assigned.\nYou can get ",(0,i.kt)("inlineCode",{parentName:"p"},"deviceID")," via ",(0,i.kt)("inlineCode",{parentName:"p"},"getDeviceId()")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().getDeviceId();\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"deviceID")," will not be sent if the data anonymization is enabled.\nNote that if you plan to send your application to the Google Play Store and your application uses AAID, you will have to ask the user of the application for the corresponding permission."),(0,i.kt)("h3",{id:"visitor-id"},"Visitor ID"),(0,i.kt)("p",null,"To track user sessions on difference sources, the VisitorID parameter is used. VisitorID is randomly generated when the tracker instance is created, and stored between application launches. It is also possible to set the VisitorID manually:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'tracker.setVisitorId("0123456789abcdef");\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A VisitorID (required) \u2013 unique visitor ID, must be 16 characters hexadecimal string.")),(0,i.kt)("p",null,"When the anonymization is enabled, a new visitor id is generated each time the application starts.\nEvery unique visitor must be assigned a different ID and this ID must not change after it is assigned. We recommend using UserID instead of VisitorID."),(0,i.kt)("h3",{id:"sessions"},"Sessions"),(0,i.kt)("p",null,"A session represents a set of user's interactions with your app. By default, Analytics is closing the session after 30 minutes of inactivity, counting from the last recorded event in session and when the user will open up the app again the new session is started. You can configure the tracker to automatically close the session when users have placed your app in the background for a period of time. That period is defined by the ",(0,i.kt)("inlineCode",{parentName:"p"},"setSessionTimeout")," method."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"tracker.setSessionTimeout(30 * 60 * 1000);\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A timeout (required) \u2013 session timeout time in ms.")),(0,i.kt)("p",null,"You can manually start a new session when sending a hit to Piwik by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"startNewSession")," method."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"tracker.startNewSession();\n")),(0,i.kt)("h3",{id:"dispatching"},"Dispatching"),(0,i.kt)("p",null,"Tracked events are stored temporarily on the queue and by default dispatched in batches every 3000 miliseconds (30 seconds). This behavior can be changed with the following options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setDispatchInterval(0)")," - incoming events will be dispatched immediately"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setDispatchInterval(-1)")," - incoming events will not be dispatched automatically. This lets you gain full control over dispatch process, by using manual dispatch, as in the example below."),(0,i.kt)("li",{parentName:"ul"},"A dispatchInterval (required) \u2013 dispatch interval time in ms.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"    Tracker tracker = ((MyApplication) getApplication()).getTracker();\n    tracker.setDispatchInterval(-1);\n    // Catch and track exception\n    try {\n        cartItems = getCartItems();\n    } catch (Exception e) {\n        tracker.trackException(e, e.getMessage(), false);\n        tracker.dispatch();\n        cartItems = null;\n    }\n")),(0,i.kt)("p",null,"In case when more than one event is in the queue, data is sent in bulk (using POST method with JSON payload). "),(0,i.kt)("h3",{id:"custom-queries"},"Custom queries"),(0,i.kt)("p",null,"You should be able to use all common actions through the TrackHelper utility, but in some instances, you may want full control over what is sent to the server."),(0,i.kt)("p",null,"The base method for any event is ",(0,i.kt)("inlineCode",{parentName:"p"},"track"),". You can create your own ",(0,i.kt)("inlineCode",{parentName:"p"},"TrackMe")," objects, set the parameters and then send it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"TrackMe trackMe = new TrackMe()\ntrackMe.set...\n/* ... */\nTracker tracker = ((YourApplication) getApplication()).getTracker();\ntracker.track(trackMe);\n")),(0,i.kt)("h3",{id:"default-custom-variables"},"Default custom variables"),(0,i.kt)("p",null,"SDK can automatically add information about the platform version, OS version and app version in custom variables with indexes 1-3. By default, this option is turned on.\nThis can be changed via the ",(0,i.kt)("inlineCode",{parentName:"p"},"setIncludeDefaultCustomVars")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().setIncludeDefaultCustomVars(false);\n")),(0,i.kt)("p",null,"In case you need to configure custom variables separately, turn off this option and see the section above regarding tracking custom variables."),(0,i.kt)("h3",{id:"local-storage-limits"},"Local storage limits"),(0,i.kt)("p",null,"You can set limits for storing events related to maximum size and time for which events are saved in local storage as below. Events older than the set limit will be discarded on the next dispatch attempt. The Piwik backend accepts backdated events for up to 24 hours by default."),(0,i.kt)("p",null,"To change offline cache age use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setOfflineCacheAge")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"tracker.setOfflineCacheAge(80085);\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A limit (required) \u2013 time in ms after which events are deleted, 0 = unlimited, -1 = disabled offline cache.\nBy default, the limit is set to 24 ",(0,i.kt)("em",{parentName:"li"}," 60 ")," 60 * 1000 ms = 24 hours.")),(0,i.kt)("p",null,"You can also specify how large the offline cache may be. If the limit is reached, the oldest files will be deleted first. To change offline cache size use the ",(0,i.kt)("inlineCode",{parentName:"p"},"setOfflineCacheSize")," method:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"tracker.setOfflineCacheSize(16 * 1000 * 1000);\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A limit (required) \u2013 size in bytes after which events are deleted, 0 = unlimited.\nBy default, the limit is set to 4 ",(0,i.kt)("em",{parentName:"li"}," 1024 ")," 1024 bytes = 4 Mb.")),(0,i.kt)("h3",{id:"opt-out"},"Opt out"),(0,i.kt)("p",null,"You can enable an app-level opt-out flag that will disable Piwik PRO tracking across the entire app. Note that this flag must be set each time the app starts up and will default to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),". To set the app-level opt-out, use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().setOptOut(true);\n")),(0,i.kt)("h3",{id:"dry-run"},"Dry run"),(0,i.kt)("p",null,"The SDK provides a dryRun flag that, when set, prevents any data from being sent to Piwik and instead prints them in the console. The dryRun flag should be set whenever you are testing or debugging an implementation and do not want test data to appear in your Piwik reports. To set the dry run flag, use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"getTracker().setDryRunTarget(Collections.synchronizedList(new ArrayList<Packet>()));\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A dryRunTarget (required) \u2013 a data structure the data should be passed into ",(0,i.kt)("inlineCode",{parentName:"li"},"List<Packet>")," type. Set it to null to disable dry run.")))}d.isMDXComponent=!0}}]);