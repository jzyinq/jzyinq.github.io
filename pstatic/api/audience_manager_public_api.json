{"swagger": "2.0", "info": {"title": "Audience Manager API", "description": "**No authentication.**\n", "version": "16.34"}, "host": "your-instance-name.piwik.pro", "basePath": "/", "schemes": ["https", "http"], "consumes": ["application/json"], "produces": ["application/json"], "definitions": {"AudienceMembershipCheck": {"type": "object", "properties": {"result": {"type": "boolean", "description": "Specifies if user belongs to the audience.", "example": false}}}, "AttributesData": {"type": "object", "required": ["website_id", "attributes"], "properties": {"website_id": {"type": "string", "description": "ID of the website.", "example": "0fdd8cc2-93b1-428c-8373-97a452f5b10c"}, "user_id": {"type": "string", "description": "User ID.\n\nIt will let Audience Manager identify user across devices (laptop, phone) and sessions.\n", "example": "jdoe"}, "device_id": {"type": "string", "description": "Device ID.\n\nIt will let Audience Manager identify user across sessions.\n", "example": "39d96a38018f490c"}, "email": {"type": "string", "description": "User email.\n\nIt will let Audience Manager identify user across devices (laptop, phone) and sessions.\n", "example": "john@doe.com"}, "analytics_visitor_id": {"type": "string", "description": "Analytics Visitor ID of the user (previously Piwik Visitor ID).\n\nIt will let Audience Manager identify user during session.\n", "example": "39d96a38018f490c"}, "attributes": {"type": "array", "description": "Attributes of the occurred event.", "items": {"type": "object", "required": ["name", "value"], "properties": {"name": {"type": "string", "description": "Name of the attribute."}, "value": {"type": "string or float", "description": "Value of the attribute. Value type must match attribute type\nconfigured in Audience Manager.\n"}, "action": {"type": "string", "enum": ["set", "add", "list-add", "list-remove"], "default": "set", "description": "Action to perform:\n* `set` \u2013 overwrite the existing value with the new value,\n* `add` \u2013 add the new value (or 1, if not specified) to the existing value,\n* `list-add` - new value will be a list containing previous value(s) in addition to the added value,\n* `list-remove` - new value will be a list containing previous value(s) without the removed value.\n"}}, "example": {"name": "occupation", "value": "unicorn"}}}}}, "Attributes": {"type": "array", "items": {"type": "object", "properties": {"name": {"type": "string", "description": "Name of the attribute.", "example": "name"}, "value": {"type": "string", "description": "Value of the attribute.", "example": "Amelia"}, "field_type": {"type": "string", "description": "Type of the attribute:\n\n  - ``analytics`` - Analytics attributes about the user (e.g. browser name, browser version, country)\n  - ``attributes`` - Custom attributes about the user (e.g. first name, last name, email)\n", "enum": ["attributes", "analytics"]}}}}}, "parameters": {"WebsiteId": {"name": "website_id", "in": "query", "type": "string", "format": "uuid", "description": "App ID (previously Website ID).", "required": true, "example": "0fdd8cc2-93b1-428c-8373-97a452f5b10"}, "AnalyticsVisitorId": {"name": "analytics_visitor_id", "in": "path", "type": "string", "format": "string", "description": "Analytics Visitor ID (previously Piwik Visitor ID).", "required": true, "example": "3a0133748b3e524c"}}, "paths": {"/audiences/public/api/profiles/{analytics_visitor_id}/audiences/": {"get": {"tags": ["audiences"], "summary": "Get audiences user belongs to", "description": "Returns list of audience IDs user belongs to.\n\nAudience ID can be found in `Audience Manager` > `Audiences` tab. Then select an audience. Its ID is displayed in\naudience details (below the name).\n", "parameters": [{"$ref": "#/parameters/WebsiteId"}, {"$ref": "#/parameters/AnalyticsVisitorId"}], "responses": {"200": {"description": "OK", "schema": {"type": "array", "items": {"type": "string", "example": "0fdd8cc2-93b1-428c-8373-97a452f5b10"}}}, "400": {"description": "Bad Request"}, "403": {"description": "Forbidden"}}}}, "/audiences/public/api/profiles/{analytics_visitor_id}/audiences/check/": {"get": {"tags": ["audiences"], "summary": "Check that user belongs to specific audience", "description": "Checks if the user belongs to specific audience.\n\nAudience ID can be found in `Audience Manager` > `Audiences` tab. Then select an audience. Its ID is displayed in\naudience details (below the name).\n", "parameters": [{"$ref": "#/parameters/WebsiteId"}, {"$ref": "#/parameters/AnalyticsVisitorId"}, {"name": "audience_id", "in": "query", "type": "string", "format": "uuid", "description": "ID of the audience.", "required": true, "example": "edd3b737-e390-4c14-af21-ce1cdbb572b7"}], "responses": {"200": {"description": "OK", "schema": {"$ref": "#/definitions/AudienceMembershipCheck"}}, "400": {"description": "Bad Request"}, "403": {"description": "Forbidden"}}}}, "/audiences/tracker/attributes/": {"post": {"tags": ["attributes"], "summary": "Create or update user attributes", "description": "Creates or updates user custom attributes.\n\nAny attribute can be updated this way whether it is on the attribute whitelist or not.\n\nYou can send data in batches - multiple profiles in one request and multiple attributes in the profile. All of the\ndata in one batch request should be related to websites that belong to the same organization.\n\nEach item must have at least one identifier:\n\n  - ``user_id``\n  - ``email``\n  - ``analytics_visitor_id``\n  - ``device_id``\n", "parameters": [{"name": "attributes_data", "in": "body", "required": true, "schema": {"type": "array", "items": {"$ref": "#/definitions/AttributesData"}}}], "responses": {"204": {"description": "No Content"}, "400": {"description": "Bad Request"}, "403": {"description": "Forbidden"}}}}, "/audiences/public/api/profiles/{analytics_visitor_id}/attributes/": {"get": {"tags": ["attributes"], "summary": "Get user profile attributes", "description": "Returns a list of user profile attributes.\n\nIn order to secure the PII data, no attribute is returned by default. You need to put each attribute you want to\naccess on the attribute whitelist before it\u2019ll be returned by this endpoint. In order to do that, go to\n`Audience Manager` > `Attributes` tab and `enable` attribute for the public API access. It is your responsibility to\nmake sure no user PII data will be available via API.\n", "parameters": [{"$ref": "#/parameters/WebsiteId"}, {"$ref": "#/parameters/AnalyticsVisitorId"}], "responses": {"200": {"description": "OK", "schema": {"$ref": "#/definitions/Attributes"}}, "400": {"description": "Bad Request"}, "404": {"description": "Not Found"}, "403": {"description": "Forbidden"}}}}}}