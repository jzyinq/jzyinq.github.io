{"swagger": "2.0", "info": {"title": "Authorized Audience Manager API", "description": "In order to acces those endpoints, you need to **authenticate**.\n<a href=\"../../platform/getting_started.html\">Here is a guide on how to do it.</a>\n", "version": "16.34"}, "host": "your-instance-name.piwik.pro", "basePath": "/", "schemes": ["https", "http"], "consumes": ["application/json"], "produces": ["application/json"], "definitions": {"Audience": {"type": "object", "properties": {"type": {"type": "string", "description": "JSONAPI `type` member, for this enpoint it's always `Audience`", "example": "Audience"}, "id": {"type": "string", "format": "uuid", "description": "ID of the audience.", "example": "9d7ade4d-7c90-4ba9-8c1a-a47d169dc6db"}, "attributes": {"type": "object", "properties": {"name": {"type": "string", "description": "Name of the audience.", "example": "Team Periwinkle"}, "count": {"type": "integer", "description": "Number of profiles in this audience (refreshed periodically).", "example": 9147}, "history_count": {"type": "array", "description": "List of audience counts for the last 30 days.", "items": {"$ref": "#/definitions/AudienceCount"}}, "is_deleted": {"type": "boolean", "description": "Determines if audience is deleted.", "example": false}}}}}, "ExportData": {"type": "object", "required": ["website_id", "audience_id", "columns"], "properties": {"website_id": {"type": "string", "description": "ID of the website.", "example": "0fdd8cc2-93b1-428c-8373-97a452f5b10c"}, "audience_id": {"type": "string", "format": "uuid", "description": "ID of the audience.", "example": "9d7ade4d-7c90-4ba9-8c1a-a47d169dc6db"}, "format": {"type": "string", "description": "Desired output format of export procedure.", "enum": ["csv", "json"]}, "columns": {"type": "array", "description": "List of columns selected to be exported to the CSV file. If the list is empty, then export all available custom attributes.", "items": {"$ref": "#/definitions/ExportAttribute"}, "example": [{"field_type": "profile", "name": "analytics_visitor_id"}, {"field_type": "analytics", "name": "browser_name"}]}}}, "ExportAttribute": {"type": "object", "properties": {"name": {"type": "string", "description": "Name of the attribute."}, "field_type": {"type": "string", "description": "Type of the attribute:\n\n  - ``profile`` - Profile identifiers of the user, choices: <code>analytics_visitor_id</code>, <code>analytics_visitor_ids</code>, <code>email</code>, <code>user_id</code>, <code>device_ids</code>\n  - ``analytics`` - Analytics attributes about the user, e.g. <code>browser_name</code>, <code>device_type</code>, <code>country</code>\n  - ``attributes`` - Custom attributes about the user\n", "enum": ["profile", "attributes", "analytics"]}}}, "AudienceCount": {"type": "object", "properties": {"date": {"type": "string", "description": "Date.", "example": "2019-10-07"}, "count": {"type": "integer", "description": "Audience count.", "example": 42}}}, "ProfileDetails": {"type": "object", "allOf": [{"type": "object", "properties": {"attributes": {"type": "object", "description": "Key-value attributes of the profile.", "example": {"occupation": "wizard", "location": "whimsyshire"}}, "forms": {"type": "object", "description": "Most recent URL and timestamp for each form submission.", "example": {"signup": {"timestamp": "2017-06-22T13:17:38.696535", "url": "http://www.example.com/"}}}, "analytics": {"type": "object", "description": "Key-balue attributes sent by analytics module.", "example": {"signup": {"timestamp": "2017-06-22T13:17:38.696535", "url": "http://www.example.com/"}}}, "goals": {"type": "object", "description": "Tracked goal conversions. Keys of this object are goal ids.", "example": {"5": {"conversion_count": 2, "last_conversion": "2018-01-18T09:01:49"}}}, "ecommerce": {"type": "object", "description": "Tracked ecommerce conversions. If no conversions are tracked, this object is empty.", "properties": {"last_conversion": {"type": "string", "format": "date-time", "description": "Last conversion datetime.", "example": "2017-07-14T08:33:53.215948Z"}, "number_of_orders": {"type": "integer", "description": "Number of conversions.", "example": 4}, "last_revenue": {"type": "float", "description": "Amount of last transaction.", "example": 13.37}, "total_revenue": {"type": "float", "description": "Total amount of transactions tracked by audience manager.", "example": 13.37}}}, "generic": {"type": "object", "description": "Generic key-value attributes of the profile.", "example": {"total_revenue": 1}}, "updated_at": {"type": "string", "format": "date-time", "description": "Last update datetime.", "example": "2017-07-14T08:33:53.215948Z"}}}, {"$ref": "#/definitions/ProfileList"}]}, "ProfileList": {"type": "object", "properties": {"id": {"type": "string", "description": "Unique ID of the profile.", "example": "0fdd8cc293b1428c837397a452f5b10c:908795389524b7ed"}, "analytics_visitor_id": {"type": "string", "description": "Main Piwik ID of the profile. Only Visible if exists.", "example": "908795389524b7ed"}, "user_id": {"type": "string", "description": "User's id in client's system. Only Visible if exists.", "example": "908795389524b7ed"}, "device_ids": {"description": "Piwik IDs of the profile. Only Visible if exists.", "type": "array", "items": {"type": "string", "description": "Main Piwik ID of the profile.", "example": "908795389524b7ed"}}, "email": {"type": "string", "description": "Email address of the profile. Only Visible if exists.", "example": "example@example.com"}, "attributes_count": {"type": "integer", "description": "Number of attributes of the profile.", "example": 4}}}}, "parameters": {"WebsiteId": {"name": "website_id", "in": "query", "type": "string", "format": "uuid", "description": "App ID (previously Website ID).", "required": true, "example": "0fdd8cc2-93b1-428c-8373-97a452f5b10"}}, "paths": {"/api/audiences/v1/audiences/": {"get": {"tags": ["audiences"], "summary": "List audiences", "description": "Returns a list of audiences for specified website.\n", "parameters": [{"name": "website_id", "in": "query", "type": "string", "description": "ID of the website.", "required": true}, {"name": "limit", "type": "integer", "maximum": 100, "in": "query", "description": "Maximum number of results to return.", "default": 10}, {"name": "offset", "type": "integer", "in": "query", "description": "Offset of the paginated results.", "default": 0}, {"name": "name", "type": "string", "in": "query", "description": "Filter results by a fragment of its name (case insensitive)."}, {"name": "order_by", "type": "string", "in": "query", "description": "Sorting order for the results. Include <code>-</code> prefix in value to get a descending order.\n", "default": "name", "enum": ["name", "count", "created_at", "updated_at"]}, {"name": "include_deleted", "type": "boolean", "in": "query", "description": "Specified if deleted audiences should be included in response.", "default": false}], "responses": {"200": {"description": "OK", "schema": {"type": "object", "properties": {"data": {"type": "array", "items": {"$ref": "#/definitions/Audience"}}}}}, "403": {"description": "Forbidden"}}}}, "/api/audiences/v1/profiles/": {"post": {"tags": ["profiles"], "summary": "Stream profiles", "description": "Streams profiles belonging to selected audience as a file with selected columns and format. There is a limit of 1,000,000 profiles over which this endpoint will return error 400. Response will be streamed. We strongly recommend using `Accept-Encoding: gzip` header on the client, as the responses can be huge depending on amount of profiles and exported fields.\n", "parameters": [{"name": "body", "in": "body", "type": "object", "schema": {"$ref": "#/definitions/ExportData"}}], "responses": {"200": {"description": "OK"}, "400": {"description": "Bad Request"}, "403": {"description": "Forbidden"}}}}, "/api/audiences/v1/profiles/get": {"get": {"tags": ["profiles"], "summary": "Get profile by identifier", "description": "Return profile by user_id, email, analytics_visitor_id, or device_id.\n", "parameters": [{"name": "website_id", "in": "query", "type": "string", "description": "ID of the website.", "required": true}, {"name": "value", "required": true, "in": "query", "type": "string", "example": "ukjwycfnaguazyno", "description": "Filter profiles by this identifier\n"}, {"name": "identifier", "required": true, "in": "query", "type": "string", "enum": ["user_id", "email", "analytics_visitor_id", "device_id"], "description": "Type of provided identifier\n"}, {"name": "limit", "in": "query", "type": "integer", "maximum": 1000, "minimum": 1, "default": 10, "description": "Number of results to return.\n"}], "responses": {"200": {"description": "OK", "schema": {"type": "array", "items": {"$ref": "#/definitions/ProfileDetails"}}}, "403": {"description": "Forbidden"}}}}}}